<!DOCTYPE html>
<html lang="en">
  <head>
  
  </head>

  <body>

    <h1>user Input</h1>
    <input type="text" id="userInput" />
    <br><h1>message input</h1>
    <input type="text" id="messageInput" />
    <button id="sendButton">Send Message</button>
    <br><br>

    <h1>MESSAGES BELOW</h1>
    <ul id="messagesList"></ul>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/microsoft-signalr/7.0.0/signalr.min.js"></script>
    <script type="text/javascript">

      function tokenValue() {
        return "eyJhbGciOiJIUzUxMiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6InJ5YW5iaGlsbGlzQGdtYWlsLmNvbSIsImdpdmVuX25hbWUiOiIxNjc2ZGQ0My02ZjFmLTRkMjctYTVlNS1mYWUzNjEwNGNiMTUiLCJuYmYiOjE3NDU2OTg3MjUsImV4cCI6MTc0NjMwMzUyNSwiaWF0IjoxNzQ1Njk4NzI1LCJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjUyNDYiLCJhdWQiOiJodHRwOi8vbG9jYWxob3N0OjUyNDYifQ.x7DSCW2hGzwYgiGb6ejIDkULm3SvkrjArjdcREjQJsOnmZBWCO72aDt6HNE-SzHMigoPNFjlVPjatAcd2i9feA";
      }

      const connection = new signalR.HubConnectionBuilder()
          .withUrl("/chat", { accessTokenFactory: () => tokenValue()})
          .build();

  
      // Start the connection
      connection.start().then(() => {
          console.log("Connected to SignalR");
      }).catch(err => console.error(err));
  
      // Send message to the hub
      document.getElementById("sendButton").addEventListener("click", function () {
          const user = document.getElementById("userInput").value;
          const message = document.getElementById("messageInput").value;
          connection.invoke("SendMessage", user, message).catch(err => console.error(err));
      });
  
      // Receive messages from the hub
      connection.on("ReceiveMessage", function (user, message) {
          const li = document.createElement("li");
          li.textContent = `${user}: ${message}`;
          document.getElementById("messagesList").appendChild(li);
      });

      
  </script>
  </body>
</html>